Set-ExecutionPolicy Unrestricted -Force

Install-WindowsUpdate -Full

Set-WindowsExplorerOptions -EnableShowHiddenFilesFoldersDrives -EnableShowProtectedOSFiles -EnableShowFileExtensions -EnableShowFullPathInTitleBar

Enable-RemoteDesktop

Disable-ComputerRestore "C:\"

New-ItemProperty 'HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU' -name 'NoAutoRebootWithLoggedOnUsers' -value '1' -propertyType "DWord"b -force
New-ItemProperty 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer' -name 'NoTaskGrouping' -value '1' -propertyType "DWord" -force

#regedit /s "D:\Dropbox\Portable_Programme\Scripts\consolez_contextmenue.reg"

$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:USERPROFILE\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\large-script.lnk")
$Shortcut.TargetPath = "D:\Dropbox\Portable_Programme\Scripts\MISC\Large-Script\Large-Script.ahk"
$Shortcut.WorkingDirectory  = "D:\Dropbox\Portable_Programme\Scripts\MISC\Large-Script\"
$Shortcut.Save()

#not sure if right way of doing it.
#Set-ItemProperty -Path REG:\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Beep\ -Name Start -Value 4 
#
##################################################################################################################
# partly Disable windows sounds
##################################################################################################################
#Push-Location
#
#Set-Location HKCU:\AppEvents\Schemes
#
#add sound profile Less Annyoing
New-Item -path .\Names -Name .LessAnnyoing -Value "Less Annoying"
#Set-ItemProperty -Path ".\" -Name "(Default)" -Value ".LessAnnyoing"
#
#add .LessAnnyoing to each sound event
#Get-ChildItem .\Apps |
#ForEach-Object { Get-ChildItem $_.pspath } | ForEach-Object { Copy-Item -Path ($_.pspath + "\.default") -Destination ($_.pspath + ".LessAnnyoing") } 
#
#change sounds for events  $keys in all profiles in $profiles.
#$keys = @("WindowsUAC")
#$profiles = @(".LessAnnyoing", ".Current")
#for ($i=0; $i -lt $keys.length; $i++) {
#	for ($j=0; $j -lt $profiles.length; $j++) {
#		Set-ItemProperty -Path (".\Apps\.Default\" + $keys[$i] + "\" + $profiles[$j]) -Name "(Default)" -Value ""
#	}
#}
#
#Set-ItemProperty -Path  -Name Start -Value 4 
#
#Pop-Location

##################################################################################################################
# install packages
##################################################################################################################

cinst chocolatey
cinst chocolateygui
cinst boxstarter
cinst dropbox
#cinst geforce-experience 
#cinst geforce-game-ready-driver 
#cinst logitechgaming 
cinst multicommander
cinst flashplayerplugin
cinst notepadplusplus.install 
cinst notepadreplacer -ia '"/NOTEPAD=""C:\Program Files (x86)\Notepad++\notepad++.exe"" /VERYSILENT"'
cinst firefox
cinst googlechrome
cinst javaruntime 
cinst potplayer
cinst 7zip.install
cinst git
#cinst winscp.install
#cinst keepass
#cinst kitty.portable 
cinst tortoisehg 
cinst teamviewer
cinst virtualbox
cinst windirstat
#cinst consolez
cinst foxitreader 
cinst sumatrapdf.install
#cinst pdfxchangeviewer
cinst autohotkey.install 
cinst irfanview 
cinst inkscape
cinst blender
cinst lockhunter 
cinst skype
cinst sysinternals
cinst rdcman 
cinst pycharm-community
cinst canopy
cinst miktex
cinst texniccenter

#cinst zotero-standalone 
#cinst thunderbird
cinst gimp
#cinst steam
#cinst uplay
#choco install uplay 
cinst spotify
#cinst nmap #network scanner
cinst procmon 

#Alle installierbaren apps deinstallieren
Get-AppxPackage -AllUsers | Remove-AppxPackage

# Download the file to a specific location
#$clnt = new-object System.Net.WebClient
#$url = "https://steamcdn-a.akamaihd.net/client/installer/steamcmd.zip"
#$file = "$env:USERPROFILE\Desktop\steamcmd.zip"
#$clnt.DownloadFile($url,$file)

# Unzip the file to specified location
#$shell_app=new-object -com shell.application 
#$zip_file = $shell_app.namespace($file) 
#$destination = $shell_app.namespace("C:\Program Files (x86)\Steam") 
#$destination.Copyhere($zip_file.items())

#Copy-Item "D:\Dropbox\Portable_Programme\Scripts\Powershell\Windows_Search_steam_links\update_steam_links_for_windows_search.ps1" "C#:\Program Files (x86)\Steam\"
#Copy-Item "D:\Dropbox\Portable_Programme\Scripts\Powershell\Windows_Search_steam_links\runit.bat" "C:\Users\Temporaernutzer\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup"

#cinst origin
